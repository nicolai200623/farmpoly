# Polymarket Trading Bot Configuration
# =====================================
# Updated with V2 features: Playwright, Gamma API, USDC Approval

# Capital Settings
total_capital: 100  # Total capital in USDC (start small!)
num_wallets: 1  # Number of wallets to use (2-10 recommended)

# RPC Settings
rpc_url: "https://polygon-mainnet.g.alchemy.com/v2/FQJnJWsEQLZqOJuRTH6n_FZEkyWx2vO1"  # Use your own Alchemy/Infura for better reliability

# Market Scanner Settings (V2 - Playwright + Gamma API)
market_scanner:
  interval: 5  # Scan interval in seconds
  min_reward: 100  # Minimum reward in USD (LOWERED to catch more markets)
  max_competition_bars: 2  # Maximum competition level (0-5) - INCREASED to allow more markets
  min_shares: 500  # Maximum minimum shares requirement

  # API Settings
  use_gamma_api: true  # Use Gamma API (faster, more reliable)
  api_fallback: true  # Fallback to Playwright if API fails

  # Categories to focus on
  target_categories:
    - sports
   # - entertainment
    #- crypto

  # Illiquid market threshold
  illiquid_threshold: 10000  # Markets with liquidity < $10k

# Market Selection AI
market_selection:
  # Scoring weights
  reward_weight: 0.4
  competition_weight: 0.3
  volume_weight: 0.2
  liquidity_weight: 0.1
  
  # Volume spike detection
  volume_spike_multiplier: 2.0
  volume_lookback_hours: 24
  
  # Maximum markets to trade simultaneously
  max_concurrent_markets: 1

# Order Management
order_management:
  # Dynamic spread range (in decimal, e.g., 0.008 = 0.8 cents)
  spread_min: 0.005  # 0.8 cents
  spread_max: 0.015  # 1.5 cents
  
  # Position size range (number of shares)
   size_min: 50   # Giảm từ 200 xuống 50
   size_max: 100  # Giảm từ 500 xuống 100
  
  # Order type
  order_type: limit
  time_in_force: GTC  # Good Till Cancelled
  
  # Order update frequency
  update_interval: 30  # seconds
  
  # Price improvement attempts
  price_improvement_enabled: true
  price_improvement_tick: 0.001  # 0.1 cent

# Position Monitoring
monitoring:
  # WebSocket monitoring interval
  websocket_interval: 10  # seconds
  
  # Auto-cancel conditions
  partial_fill_threshold: 0.1  # Cancel if >10% filled
  volume_spike_multiplier: 2  # Cancel if volume spikes >2x
  price_move_threshold: 0.02  # Cancel if price moves >2 cents
  
  # Position timeout
  max_position_age: 3600  # 1 hour in seconds
  
  # Monitoring alerts
  alert_on_fill: true
  alert_on_cancel: false

# Risk Management
risk_management:
  # Capital allocation
  max_capital_per_market: 0.05  # 5% of total capital
  max_total_exposure: 0.8  # 80% of total capital
  
  # Hedging
  enable_hedging: true
  hedge_threshold: 0.6  # Hedge if imbalance >60%
  partial_hedge_ratio: 0.5  # Hedge 50% of imbalance
  
  # Correlation limits
  max_markets_per_category: 3
  
  # Stop loss
  enable_stop_loss: true
  stop_loss_percentage: 0.15  # 15% loss per market
  
  # Value at Risk
  var_confidence: 0.95  # 95% confidence level
  max_var_percentage: 0.1  # 10% of capital

# Wallet Management
wallet_management:
  # Number of wallets to rotate
  num_wallets: 1
  
  # Human-like behavior
  jitter_percentage: 0.2  # ±20% variation
  min_wallet_cooldown: 30  # seconds between uses
  
  # Wallet switching
  random_switch_probability: 0.2  # 20% chance of random wallet
  time_based_switch: true
  switch_interval_min: 180  # 3 minutes
  switch_interval_max: 300  # 5 minutes
  
  # Human behavior simulation
  enable_breaks: true
  break_probability: 0.05  # 5% chance
  break_duration_min: 30  # seconds
  break_duration_max: 180  # seconds
  
  # Typing/action delays
  micro_delay_min: 0.05  # seconds
  micro_delay_max: 0.15  # seconds
  action_delay_min: 0.5  # seconds
  action_delay_max: 2.0  # seconds

# ML Prediction
ml_prediction:
  # Fill risk threshold
  fill_risk_threshold: 0.8  # Alert if >80% fill probability
  
  # Model training
  model_update_interval: 3600  # 1 hour in seconds
  min_training_samples: 100
  max_training_samples: 10000
  
  # Model parameters
  learning_rate: 0.001
  epochs: 50
  batch_size: 32
  
  # Feature engineering
  enable_feature_scaling: true
  feature_selection: auto
  
  # Model persistence
  model_path: models/fill_predictor.pt
  save_training_data: true
  training_data_path: data/training_data.pkl

# Daily Optimization
daily_optimization:
  # Optimization schedule (UTC)
  optimization_hour: 0  # Midnight UTC
  optimization_minute: 0
  
  # Performance analysis
  lookback_days: 7
  min_trades_for_analysis: 20
  
  # Strategy adjustment
  enable_auto_adjustment: true
  adjustment_sensitivity: 0.1  # 10% adjustment max
  
  # Payout calculation
  include_unrealized_pnl: false
  
  # Redeployment
  redeploy_underperforming: true
  performance_threshold: -0.05  # -5% return

# Reward Management (Automated Reward Checking & Withdrawal)
reward_management:
  # Enable automated reward checking and withdrawal
  # ⚠️ DISABLED FOR NOW - Bot is confusing trading capital with rewards!
  # Only enable this after you understand how Polymarket rewards work
  enabled: false

  # Check interval (in seconds)
  # 3600 = 1 hour, 7200 = 2 hours, 14400 = 4 hours, 86400 = 24 hours
  check_interval: 86400  # Check every 24 hours (not every hour!)

  # Minimum reward threshold before triggering withdrawal (in USDC)
  min_withdrawal_threshold: 10000.0  # Withdraw when rewards >= $50 (increased for safety)

  # Withdrawal wallet address (set in .env for security)
  # This is where rewards will be sent
  withdrawal_wallet: ""  # Set REWARD_WITHDRAWAL_WALLET in .env

  # Maximum gas price for withdrawal transactions (in Gwei)
  max_gas_price: 500  # Don't withdraw if gas > 500 Gwei

  # Retry settings for failed withdrawals
  max_retry_attempts: 3
  retry_delay: 300  # 5 minutes between retries

  # Alert settings
  alert_on_withdrawal: true  # Send alert when withdrawal occurs
  alert_on_withdrawal_failure: true  # Send alert on withdrawal failure
  alert_on_threshold_reached: true  # Send alert when threshold is reached

  # Safety settings
  require_confirmation: true  # REQUIRE manual confirmation before withdrawal!
  max_withdrawal_per_day: 1000.0  # Maximum USDC to withdraw per day (safety limit)

# Alerts and Notifications
alerts:
  # Telegram
  telegram_enabled: true
  telegram_bot_token: ""  # Set in .env
  telegram_chat_id: ""  # Set in .env

  # Discord/Slack Webhook
  webhook_enabled: false
  webhook_url: ""  # Set in .env

  # Alert levels
  alert_on_startup: true
  alert_on_shutdown: true
  alert_on_error: true
  alert_on_high_risk: true
  alert_on_daily_report: true

  # Performance alerts
  alert_on_profit_threshold: 100  # USD
  alert_on_loss_threshold: -50  # USD

# Polymarket CLOB Settings
clob:
  host: "https://clob.polymarket.com"
  chain_id: 137  # Polygon mainnet
  
  # API endpoints
  api_base: "https://polymarket.com/api"
  rewards_endpoint: "/rewards"
  markets_endpoint: "/markets"
  
  # Rate limiting
  max_requests_per_second: 10
  request_timeout: 30  # seconds
  
  # WebSocket
  websocket_url: "wss://ws-subscriptions-clob.polymarket.com/ws"
  websocket_reconnect_delay: 5  # seconds
  websocket_ping_interval: 30  # seconds

# Blockchain Settings
blockchain:
  # Polygon RPC
  rpc_url: "https://polygon-rpc.com"
  backup_rpc_urls:
    - "https://rpc-mainnet.matic.network"
    - "https://polygon-mainnet.infura.io/v3/YOUR_INFURA_KEY"
  
  # Gas settings
  max_gas_price: 500  # Gwei
  gas_price_multiplier: 1.1  # 10% above suggested
  
  # Transaction settings
  max_retries: 3
  retry_delay: 5  # seconds
  confirmation_blocks: 2

# Logging
logging:
  level: INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  
  # File logging
  log_to_file: true
  log_file: logs/polymarket_bot.log
  log_rotation: daily
  log_retention_days: 30
  
  # Console logging
  log_to_console: true
  colored_logs: true
  
  # Performance logging
  log_performance_metrics: true
  metrics_interval: 300  # 5 minutes

# Database (Optional)
database:
  enabled: false
  type: sqlite  # sqlite, postgresql, mongodb
  
  # SQLite
  sqlite_path: data/bot_data.db
  
  # PostgreSQL
  postgres_host: localhost
  postgres_port: 5432
  postgres_database: polymarket_bot
  postgres_user: ""  # Set in .env
  postgres_password: ""  # Set in .env
  
  # MongoDB
  mongodb_uri: ""  # Set in .env
  mongodb_database: polymarket_bot

# Performance Tuning
performance:
  # Async settings
  max_concurrent_tasks: 50
  task_timeout: 60  # seconds
  
  # Caching
  enable_caching: true
  cache_ttl: 300  # 5 minutes
  
  # Connection pooling
  connection_pool_size: 10
  
  # Memory management
  max_memory_mb: 1024  # 1GB
  gc_interval: 600  # 10 minutes

# Development/Testing
development:
  # Test mode (no real orders) - SET TO FALSE FOR LIVE TRADING
  test_mode: false

  # Paper trading - SET TO FALSE FOR LIVE TRADING
  paper_trading: false
  paper_trading_capital: 10000

  # Simulation
  simulate_fills: false
  fill_simulation_probability: 0.3

  # Debug features
  verbose_logging: false
  save_debug_data: false
  debug_data_path: data/debug/

